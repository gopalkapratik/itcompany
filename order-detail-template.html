<div class="container">
    <div class="row">
        <div class="col-md-12">
        <div class="middle_content pos-relative mb-3">
                <div class="company_detail">
                            <div class="row">
                            <div class="col-md-8"><div class="row">
                            <div class="col-md-12"><div class="order_summary_heading"><div class="order_num">Order Number : <b id="order_Number_val"></b></div> 
                            <div class="process_status">Processing Status : <b id="processing_status"></b></div></div></div>
                            <div class="col-md-12">
                              <div class="card company-acc-info">
                                <div class="card-body">
                                   <div class="row row d-flex flex-wrap" id="orderSummaryInfo"></div>
                                </div>
                                </div>
                              </div>
                            </div>
                </div>                            
                </div>
            </div>
        </div>
    </div>
             
    </div>
</div>
<script type="text/javascript" src="/jquery.dataTables.min.js"></script>



//Advance Code Start
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const saleorderid = urlParams.get('id');
var deliveryModeDiscription = '';
$(function () {
                $.ajax({
                    type: "GET",
                    url: "{{ settings['AzureGetOrderSummarydetailsFun'] }}&saleorderid="+saleorderid,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (response) {                         
                        var length = '';
                        var productDetailTable = '';
                        var soNotificationTable = '';
                        var orderSummaryDetail = '';
                        var orderSummaryBillAddr = ''; 
                        var orderSummaryDeliveryAddr = '';
                        var results = response;

                        if(response != undefined && response != "" && response != null){
                        var estshipdate = response.confirmedShippingDate;
                        //var shipdateparts = estshipdate[0].split('-');
                        //var finalshipdate = shipdateparts[1] +'/' + shipdateparts[2] +'/'+ shipdateparts[0];
                        var receiptDate = response.requestDeliveryby.split('T');
                        var receiptdateparts = receiptDate[0].split('-');
                        var finalreceiptDate = receiptdateparts[1] +'/' + receiptdateparts[2] +'/'+ receiptdateparts[0];
                        var orderDate = response.createdOn.split('T');
                        var orderdateparts = orderDate[0].split('-');
                        var finalorderDate = orderdateparts[1] +'/' + orderdateparts[2] +'/'+ orderdateparts[0];
                        var order_Number_val = response.salesorderNumber ? response.salesorderNumber:"--";
                        var processing_status = response.portalProcessingStatus ? response.portalProcessingStatus:"--";

                        var deliveryTermsDiscription = response.deliveryTermsDiscription;
                        deliveryModeDiscription = response.deliveryModeDiscription;
                        if(estshipdate == null) 
                        {
                            estshipdate = '';
                        }
                        if(deliveryTermsDiscription == null)
                        {
                            deliveryTermsDiscription = '';
                        }
                        if(deliveryModeDiscription == null)
                        {
                            deliveryModeDiscription = '';
                        }

                        
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>PO Number</label><b>'+response.customersOrderReference+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Requested Receipt Date</label><b>'+response.requestDeliveryby+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Estimated Shipping Date</label><b>'+estshipdate+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Order Date</label><b>'+response.createdOn+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Incoterm</label><b>'+deliveryTermsDiscription+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Carrier</label><b>'+deliveryModeDiscription+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Attention To</label><b>'+response.shiptoAttention+'</b></div>'
                        orderSummaryDetail +='<div class="col-md-12 col-xs-6 mb-2"><div class="horizontal_line"></div></div>'
                        orderSummaryDetail +='<div class="col-md-3 col-xs-6 mb-2"><label>Sub total</label><b>$'+Number(response.totalAmountLessFreight).toFixed(2)+'</b></div>'
                        
                        
                        orderSummaryDetail+='<table class="table" id="comp_acc_datatable">'
                        orderSummaryDetail+='<thead>'
                        orderSummaryDetail+='<thead>'
                        orderSummaryDetail+='<tr>'
                        orderSummaryDetail+='<th scope="col">#</th>'
                        orderSummaryDetail+='<th scope="col">Item No</th>'
                        orderSummaryDetail+='<th scope="col">Name</th>'
                        orderSummaryDetail+='<th scope="col">Quantity</th>'
                        orderSummaryDetail+='<th scope="col">Unit Price</th>'
                        orderSummaryDetail+='<th scope="col">Net Amount</th>'
                        orderSummaryDetail+='</tr>'
                        orderSummaryDetail+='</thead>'
                        orderSummaryDetail +='<tbody id="comp_acc_datatable_body">'
                        for (var i = 0; i < response.orderProductDetailsModel.length; i++) {
                            var productnumber = response.orderProductDetailsModel[i].productnumber ? response.orderProductDetailsModel[i].productnumber:"";
                            var portalproductname = response.orderProductDetailsModel[i].portalproductname ? response.orderProductDetailsModel[i].portalproductname:"";
                            var portalproductDescription = response.orderProductDetailsModel[i].portalproductDescription ? response.orderProductDetailsModel[i].portalproductDescription:"";
                            var quantity = response.orderProductDetailsModel[i].quantity ? response.orderProductDetailsModel[i].quantity:"";
                            var salsePrice = response.orderProductDetailsModel[i].salsePrice ? response.orderProductDetailsModel[i].salsePrice:"";
                            var extendedamount = response.orderProductDetailsModel[i].extendedamount ? response.orderProductDetailsModel[i].extendedamount:"";

                            orderSummaryDetail +='<tr>'
                            orderSummaryDetail +='<td>' + (i + 1) + '</td>'
                            orderSummaryDetail +='<td data-label="Item No"><b>' + productnumber + '</b></td>'
                            orderSummaryDetail +='<td data-label="Name">' + portalproductname +'<p>'+portalproductDescription+ '</p></td>'
                            orderSummaryDetail +='<td data-label="Quantity">' + Number(quantity).toFixed(0) + '</td>'
                            orderSummaryDetail +='<td data-label="Unit Price">$'+ Number(salsePrice).toFixed(2) +'</td>'
                            orderSummaryDetail +='<td data-label="Net Amount">$' + Number(extendedamount).toFixed(2) + '</td>'
                            orderSummaryDetail +='</tr>' 
                        } 
                        orderSummaryDetail+='</tbody>' 
                        orderSummaryDetail+='</table>'
                        $('#orderSummaryInfo').html(orderSummaryDetail);
                        $('#comp_acc_datatable').DataTable({
                            paging: true,    responsive: true,                
                            searching: true, ordering: true,
                            language: {
                            "lengthMenu": "Show _MENU_ records",
                            'info': "Showing _START_ to _END_ of _TOTAL_ records", 
                            'emptyTable':     "No Record Available",
                            'paginate': {
                            'previous': '<span class="prev-icon material-symbols-outlined">chevron_left</span>',
                            'next': '<span class="next-icon material-symbols-outlined">chevron_right</span>'
                            },
                            scrollY: '80px',
                            scrollCollapse: true
                            }
                        });
                        
                        }
                        

                    },
                    failure: function (response) {
                        $('#failFunction').fadeIn('fast').delay(1500).fadeOut('fast');
                    },
                    error: function (response) {
                        
                        $('#failFunction').fadeIn('fast').delay(1500).fadeOut('fast');
                    }
                });
});
